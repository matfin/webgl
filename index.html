<!DOCTYPE html>
<html lang="en">
    <head>
        <title>
            WebGL Experiments
        </title>
        <meta charset="UTF-8" />
        <meta name="description" content="WebGL Experimentation">
        <meta name="keywords" content="webgl, javascript, experiments">
        <meta name="author" content="Matt Finucane">
        <link rel="stylesheet" type="text/css" href="assets/css/stylesheets/screen.css" />
        <script type="text/javascript" src="/assets/js/glMatrix-0.9.5.min.js"></script>
        <script type="text/javascript" src="/assets/js/webgl-debug.js"></script>
        <script type="text/javascript" src="/assets/js/gl.js"></script>
        <script type="text/javascript" src="/assets/js/keyhandler.js"></script>
        <script type="text/javascript" src="/assets/js/lightinghandler.js"></script>
        <script type="text/javascript" src="/assets/js/main.js"></script>
        <!-- Shaders and fragments go in here -->
        <script id="shader-fs" type="x-shader/x-fragment">
            precision mediump float;

            varying vec2 vTextureCoord;
            varying vec3 vLightWeighting;

            uniform float uAlpha;
            
            uniform sampler2D uSampler;
            
            void main(void) {
                vec4 textureColor = texture2D(uSampler, vec2(vTextureCoord.s, vTextureCoord.t));
                gl_FragColor = vec4(textureColor.rgb * vLightWeighting, textureColor.a * uAlpha);
            }
        </script>
        <script id="shader-vs" type="x-shader/x-vertex">
            attribute vec3 aVertexPosition;
            attribute vec3 aVertexNormal;
            attribute vec2 aTextureCoord;

            uniform mat4 uMVMatrix;
            uniform mat4 uPMatrix;
            uniform mat3 uNMatrix;
            
            uniform vec3 uAmbientColor;
            
            uniform vec3 uLightingDirection;
            uniform vec3 uDirectionalColor;
            
            uniform bool uUseLighting;

            varying vec2 vTextureCoord;
            varying vec3 vLightWeighting;

            void main(void) {
                gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);
                vTextureCoord = aTextureCoord;
                
                if(!uUseLighting){
                    vLightWeighting = vec3(1.0, 1.0, 1.0);
                }
                else{
                    vec3 transformNormal = uNMatrix * aVertexNormal;
                    float directionalLightWeighting = max(dot(transformNormal, uLightingDirection), 0.0);
                    vLightWeighting = uAmbientColor + uDirectionalColor * directionalLightWeighting;
                }
            }
        </script> 
    </head>
    <body>
        <section class="container">
            <canvas id="myglcanvas" width="500" height="500">
                <p>
                    Need a browser that supports WebGL? Check out <a href="http://www.google.com/chrome" title="Google Chrome">Chrome</a>
                </p>
            </canvas>
            <form>
                <fieldset>
                    <h2>
                        Textures
                    </h2>
                    <label for="texture">
                        Texture
                    </label>
                    <select name="texture">
                        <option selected value="woodenfloor.png">
                            Wooden Floor
                        </option>
                        <option value="lynsey.png">
                            Lynsey
                        </option>
                        <option value="texture.png">
                            Photo
                        </option>
                        <option value="iqcontent.png">
                            iQContent
                        </option>
                        <option value="me.png">
                            Me
                        </option>
                    </select>
                </fieldset>
                <fieldset>
                    <h2>
                        Blending
                    </h2>
                    <label for="alpha">
                        Alpha
                    </label>
                    <input type="range" name="alpha" min="1" max="100" step="1" />
                </fieldset>
                <fieldset id="movement">
                    <h2>
                        Movement
                    </h2>
                    <label for="x_speed">
                        X
                    </label>
                    <input type="range" name="x_speed" min="-200" max="200" step="1" />
                    <label for="y_speed">
                        Y
                    </label>
                    <input type="range" name="y_speed" min="-200" max="200" step="1" />
                    <label for="y_speed">
                        Zoom
                    </label>
                    <input type="range" name="z" min="-1000" max="-200" step="1" />
                </fieldset>
                <fieldset>
                    <h2>
                        Directional Light Position
                    </h2>
                    <label for="directional_light_x">
                        X
                    </label>
                    <input type="range" name="directional_light_x" min="-100" max="10" step="1" />
                    <label for="directional_light_y">
                        Y
                    </label>
                    <input type="range" name="directional_light_y" min="-100" max="10" step="1" />
                    <label for="directional_light_z">
                        Z
                    </label>
                    <input type="range" name="directional_light_z" min="-100" max="10" step="1" />
                </fieldset>
                <fieldset>
                    <h2>
                        Directional Light Colour
                    </h2>
                    <label for="directional_color_r">
                        R
                    </label>
                    <input type="range" name="directional_color_r" min="0" max="255" />
                    <label for="directional_color_g">
                        G
                    </label>
                    <input type="range" name="directional_color_g" min="0" max="255" />
                    <label for="directional_color_b">
                        B
                    </label>
                    <input type="range" name="directional_color_b" min="0" max="255" />
                </fieldset>
                <fieldset>
                    <h2>
                        Ambient Light Colour
                    </h2>
                    <label for="ambient_color_r">
                        R
                    </label>
                    <input type="range" name="ambient_color_r" min="0" max="255" />
                    <label for="ambient_color_g">
                        G
                    </label>
                    <input type="range" name="ambient_color_g" min="0" max="255" />
                    <label for="ambient_color_b">
                        B
                    </label>
                    <input type="range" name="ambient_color_b" min="0" max="255" />
                </fieldset>
            </form>
        </section>
    </body>
</html>